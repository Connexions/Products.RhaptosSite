<div metal:define-macro="author_about_box">
<metal:block tal:define="
   memberid python:(len(request.traverse_subpath) > 0 and request.traverse_subpath[0]) or request.get('author', None);
    member python:here.desecured.getMemberById(memberid);
    member_name python:member.getUserName();
    member_since python:member.getProperty('approved_time').year;
    author_profile context/@@profile_content;
    auth_collections python:author_profile.getAuthCollectionsForMember(memberid);
  	auth_mods python:author_profile.getAuthModulesForMember(memberid);
  	maintain_mods python:author_profile.getMaintainedModulesForMember(memberid);
    maintainmod_count python:len(maintain_mods);
  	maintain_colls python:author_profile.getMaintainedCollectionsForMember(memberid);
    maintaincolls_count python:len(maintain_colls);
 	translations python:author_profile.getTranslationsForMember(memberid);
    translation_count python:len(translations);
    ">

      <tal:portrait 
      tal:define="
        portrait python:mtool.getPersonalPortrait(member.getId());
        account_type python:member.getProperty('account_type');
        is_org python:account_type != 'person';
        scale python:here.calcImageScale(image=portrait);
        p_height python:portrait.height/scale; 
        p_width python:portrait.width/scale;"
	  condition="python:portrait and (not(is_org) or portrait.title != 'Default user')">
	  <img tal:replace="structure python:portrait.tag(height=p_height,width=p_width,css_class='portraitPhoto')"
	    />

      </tal:portrait>
      <p></p>
         <ul>
                <tal:affiliation
	         tal:define="affiliation python:member.getProperty('affiliation').strip();
	                     affiliation_url python:member.getProperty('affiliation_url');" 
	              tal:condition="affiliation">
		<li><strong>Affiliation:</strong>
	         <a tal:attributes="href affiliation_url"
		tal:content="affiliation"
		tal:omit-tag="not:affiliation_url">[affiliation]</a>
                 </li>
                </tal:affiliation>
		<li><strong>Member since:</strong> <tal:since tal:replace="member_since"/></li>		
		<li><strong>Author of:</strong> <tal:item tal:replace="python:author_profile.content_authored_statement(memberid)" />
		<li><strong>Maintainer of:</strong> 
                     <tal:maintainer tal:replace="python:author_profile.content_maintained_statement(memberid)" /></li>
		<li><strong>Translator of:</strong> 
                     <tal:translator tal:replace="python:author_profile.content_translated_statement(memberid)" /></li>
	</ul>
</metal:block>
    </div>

	<div metal:define-macro="author_about_portlet">
          <ul id="portlet-navigation-tree" tal:define="
		   memberid python:(len(request.traverse_subpath) > 0 and request.traverse_subpath[0]) or request.get('author', None);
		    member python:here.desecured.getMemberById(memberid);
		    member_name python:member.getUserName();">
	      <li class="currentNavItem">
		    <a name="about">About <tal:item tal:replace="member_name" /> </a>
	      </li>
	      <li>
		    <a tal:attributes="href string:${portal_url}/member_content/${member_name}"><tal:item tal:replace="member_name" />'s Content </a>
	      </li>
       
          </ul>
                      <div metal:use-macro="context/profile_portlet/macros/author_about_box"/>
	</div>
